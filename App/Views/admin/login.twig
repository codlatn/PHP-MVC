<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <title>Admin Login</title>
</head>
<body>
    


<div class="messages ">

</div>

<form action="{{ access }}  " method="POST"  id="formLogin"  >

<input type="email" name="email"> 

<input type="password" name="password">
<input type="checkbox" id="remmber" name="remmber" >

<button type="button"  onclick="formOnSubmit();" >click</button>
</form>
 
 <br>

 <div style="color:brown">
 
</div>

 
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>

 <script>
    


    function  formOnSubmit()  {
        
       //waiting = false;
      //  if(waiting === true) waiting = false;
        
         form = $('#formLogin');
         requestUrl = form.attr('action');
         method =  form.attr('method');
         formData = form.serialize();
        $.ajax({
            url : requestUrl,
            method : method,
            data : formData,
            dataType : 'json',
            beforeSend: function(){
                $('.messages').removeClass().addClass('messages alert alert-info').text('loding');
                console.log('sending..!');
                //waiting = true;
            },
            success : function(res){
              console.log(res.errors);
              //  waiting = false;

                if(res.errors){
                    $('.messages').removeClass().addClass('messages alert alert-danger').html(res.errors);
                }else{
                    $('.messages').removeClass().addClass('messages alert alert-success').text("مرحباً " +res.name+ " تم تسجيل الدخول بنجاح و جاري تحويلكم ");
                    setTimeout(()=>{
                        location = res.redirect;
                    }, 1500);
                }

            },
        });
        return false
    }
      
 </script>
</body>
</html>